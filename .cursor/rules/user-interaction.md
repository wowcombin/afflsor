# USER INTERACTION RULES

## üéØ –ü–û–°–¢–ê–ù–û–í–ö–ê –ó–ê–î–ê–ß

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
- "–Ø Manager (pocformail@gmail.com), –Ω–µ –º–æ–≥—É –∑–∞–π—Ç–∏ –Ω–∞ /dashboard/manager/analytics - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞"
- "API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏', –≤–æ—Ç –ª–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏: [–ª–æ–≥–∏]"
- "–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã Junior –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –Ω–∞ /withdrawals, –Ω–æ –∏–¥–µ—Ç –Ω–∞ dashboard"

### ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
- "–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∞"
- "–ò—Å–ø—Ä–∞–≤—å –æ—à–∏–±–∫—É"
- "–°–¥–µ–ª–∞–π –∫–∞–∫ –≤ —Ç–µ—Ö–∑–∞–¥–∞–Ω–∏–∏"

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –í–°–ï–ì–î–ê –ó–ê–ü–†–ê–®–ò–í–ê–¢–¨:
1. **–†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –∏ email
2. **–¢–æ—á–Ω—ã–π URL** –≥–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞
3. **–¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏** –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console)
4. **–°—Ç–∞—Ç—É—Å –∫–æ–¥** –∏–∑ Network tab (–µ—Å–ª–∏ API –æ—à–∏–±–∫–∞)
5. **–ß—Ç–æ –æ–∂–∏–¥–∞–ª–æ—Å—å** vs **—á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å**

### –°–û–ó–î–ê–í–ê–¢–¨ –î–ò–ê–ì–ù–û–°–¢–ò–ß–ï–°–ö–ò–ï –ò–ù–°–¢–†–£–ú–ï–ù–¢–´:
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π ‚Üí `/debug-auth`
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å API ‚Üí `/test-api` 
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å RLS ‚Üí –ø—Ä–æ—Å—Ç—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

## üìã –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ü–†–û–í–ï–†–ö–ò

### –ü–ï–†–ï–î –ù–ê–ß–ê–õ–û–ú –†–ê–ë–û–¢–´:
- [ ] –ü—Ä–æ—á–∏—Ç–∞—Ç—å –í–°–ï —Ñ–∞–π–ª—ã vision/
- [ ] –ò–∑—É—á–∏—Ç—å middleware.ts
- [ ] –ü–æ–Ω—è—Ç—å —Å—Ö–µ–º—É –ë–î –∏–∑ supabase/migrations/
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Å–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏

### –ü–†–ò –†–ê–ë–û–¢–ï –° RLS:
- [ ] –í–∫–ª—é—á–∏—Ç—å –í–°–ï –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–æ–ª–∏ –≤ –ø–æ–ª–∏—Ç–∏–∫–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é —Ä–æ–ª—å –æ—Ç–¥–µ–ª—å–Ω–æ
- [ ] –°–æ–∑–¥–∞—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ SQL –∑–∞–ø—Ä–æ—Å—ã

### –ü–ï–†–ï–î –ö–û–ú–ú–ò–¢–û–ú:
- [ ] `npm run build` - –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ —Å–ª–æ–º–∞–ª–∏—Å—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò (–ù–ò–ö–û–ì–î–ê –ù–ï –î–ï–õ–ê–¢–¨)

1. **RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑ –≤—Å–µ—Ö —Ä–æ–ª–µ–π** - –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–∞—Ç—å manager, admin, hr –≥–¥–µ –Ω—É–∂–Ω–æ
2. **–ó–∞–≥–ª—É—à–∫–∏ –∫–∞–∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** - —Å—Ç–∞—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. **API –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫** - –≤—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è—Ç—å try/catch –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏
4. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
5. **–ö–æ–º–º–∏—Ç—ã —Å –æ—à–∏–±–∫–∞–º–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏** - —Å–Ω–∞—á–∞–ª–∞ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –ø–æ—Ç–æ–º –∫–æ–º–º–∏—Ç–∏—Ç—å

## üí¨ –ö–û–ú–ú–£–ù–ò–ö–ê–¶–ò–Ø

### –û–ë–™–Ø–°–ù–Ø–¢–¨:
- **–ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã** ("RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–µ –≤–∫–ª—é—á–∞—é—Ç —Ä–æ–ª—å manager")
- **–ß—Ç–æ –∏–º–µ–Ω–Ω–æ —Å–ª–æ–º–∞–Ω–æ** ("middleware –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")
- **–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ** ("1. –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL, 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø, 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å")

### –ù–ï –ì–û–í–û–†–ò–¢–¨:
- "–î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å"
- "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑"
- "–ü—Ä–æ–±–ª–µ–º–∞ –≤ API" (–±–µ–∑ —É—Ç–æ—á–Ω–µ–Ω–∏—è –∫–∞–∫–∞—è –∏–º–µ–Ω–Ω–æ)

## üîß –ò–ù–°–¢–†–£–ú–ï–ù–¢–´ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò

### –°–û–ó–î–ê–í–ê–¢–¨ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –ü–†–ò –ü–†–û–ë–õ–ï–ú–ê–•:
```typescript
// –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
/debug-auth - –ø–æ–∫–∞–∑–∞—Ç—å user data, auth status, role

// –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
/test-api - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ endpoints –ø–æ—à–∞–≥–æ–≤–æ

// –ü—Ä–æ—Å—Ç–æ–π API –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
/api/simple-test - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –±–µ–∑ JOIN
```

### SQL –î–õ–Ø –ü–†–û–í–ï–†–ö–ò RLS:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏
SELECT * FROM pg_policies WHERE tablename = 'users';

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT * FROM users WHERE auth_id = 'user-uuid';
```
